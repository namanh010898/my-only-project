@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
}
@{
    ViewData["Title"] = "Tạo mới Slide";
    Layout = "_Layout - Admin";
}
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>CKEditor</title>
    <script src="https://cdn.ckeditor.com/ckeditor5/33.0.0/classic/ckeditor.js"></script>
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
        <style>
        .modal-footer .btn + .btn {
            margin-bottom: 10px;
        }

        #example_wrapper {
            display : block;
        }

        /* Giao diện modal */
        input.fullwidth {
            width : 100%;
        }

        #closing-modal-black:hover {
            color :#333 !important;
        }

        .modal-row-menu {
            margin-top : 13px;
        }
    </style>

</head>

<body>
    <div class="" id="">
        <div class="modal-dialog modal-lg novaticeditForm">
            <div class="modal-content">
                <div class="modal-header bg-gradient-info">
                    <h4 class="modal-title">
                        <i class="fa fa-edit"></i> <span id="updateTitle">Thêm slide mới</span>
                    </h4>
                </div>
                <div class="modal-body">
                    <div class="container" style="display: contents"> 
                
                    <h3>Slide</h3>
                    <i>Lưu ý điền đầy đủ các thông tin có dấu <span style="color:red">*</span></i>
                    <div class="row modal-row-menu">
                        <div class="col-md-2 ">
                        <label for="Id">ID(Tự động)</label><span style="color:red">*</span>
                        </div>
                        <div class="col-md-4">
                            <input type="text" id="Id" class="fullwidth"  disabled />
                        </div>

                        <div class="col-md-2 ">
                        <label for="config">Trang hiển thị(Tự động)</label>
                        </div>
                        <div class="col-md-4">
                            <input type="text" id="config" class="fullwidth" value="slide trang chủ"  disabled />
                        </div>
                    </div>

                    <div class="row modal-row-menu">
                        <div class="col-md-2 ">
                        <label for="Name">Name</label><span style="color:red">*</span> 
                        </div>
                        <div class="col-md-10"> 
                             <input type="text" id="Name"  class="fullwidth" />
                        </div>
                    </div>

                    <div class="row modal-row-menu">
                        <div class="col-md-2 ">
                        <label for="alignment">Căn lề</label> <span style="color:red">*</span>
                        </div>
                        <div class="col-md-4">
                            @*<input type="text" id="alignment" class="fullwidth" />*@
                            <select id="alignment">
                                <option value="text-left">Trái</option>
                                <option value="text-right">Phải</option>
                                <option value="text-center">Giữa</option>
                            </select>
                        </div>

                        <div class="col-md-2 ">
                        <label for="Image">Ảnh nền</label><span style="color:red">*</span>
                        </div>
                        <div class="col-md-4"> 
                            <input class="fullwidth" type="text" name="Image" id= "Image" accept="image/*" />
                            @*<input class="fullwidth" type="file" name="Image" id= "Image" accept="image/*" />*@
                        </div>
                    </div>

                    <div class="row modal-row-menu">
                        <div class="col-md-2 ">
                        <label for="tieu-de-1">Tiêu đề 1</label><span style="color:red">*</span> 
                        </div>
                        <div class="col-md-4"> 
                             <input type="text" id="tieu-de-1"  class="fullwidth" />
                        </div>
                    </div>
                    
                    <div class="row modal-row-menu">
                        <div class="col-md-2 ">
                        <label for="tieu-de-2">Tiêu đề 2</label><span style="color:red">*</span>
                        </div>
                        <div class="col-md-10">
                            <input type="text" id="tieu-de-2"  class="fullwidth" />
                        </div>
                    </div>   
                    <div class="row modal-row-menu">
                        <div class="col-md-2 ">
                        <label for="tieu-de-3">Tiêu đề 3</label>
                        </div>
                        <div class="col-md-10">
                            <input type="text" id="tieu-de-3" class="fullwidth"   />
                        </div>
                    </div>
                    <div class="row modal-row-menu">
                        <div class="col-md-2 ">
                        <label for="button-name">Tiêu đề nút</label>
                        </div>
                        <div class="col-md-4">
                            <input type="text" id="button-name" class="fullwidth"   />
                        </div>
                        <div class="col-md-2 ">
                        <label for="button-url">Đường dẫn nút bấm</label>
                        </div>
                        <div class="col-md-4">
                            <input type="text" id="button-url" class="fullwidth"   />
                        </div>
                    </div>

                    <div class="row modal-row-menu">
                        <div class="col-md-2 ">
                        <label for="CreatedTime">Published Time<span style="color:red">*</span></label>
                        </div>
                        <div class="col-md-10">
                            <input type="datetime-local" id="CreatedTime" />
                        </div>
                    </div> 
                      
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" style="display:none" class="btn btn-default" data-dismiss="modal">
                        Close
                    </button>
                    <button type="button" class="btn btn-primary" id="btnUpdateItem"
                            onclick="Submit()">
                        Tạo mới
                    </button>
                </div>
            </div>
        </div>
    </div>
    <script>  
             
        function Submit() {
            debugger;
            var resultSubmit = true;
             

             
            if( $("#CreatedTime").val() == "" ||  $("#CreatedTime").val() == null) {
                resultSubmit = false;
                Swal.fire({
                icon: 'warning',
                title: 'Cần điền đầy đủ thông tin',
                text: 'CreatedTime không thể bị bỏ trống?',
                showCloseButton: true,
                showCancelButton: true
                });
            }

            // check thoả mãn các điều kiện trước khi tạo
            if(resultSubmit) {
                Swal.fire({
                icon: 'question',
                title: 'Confirm?',
                text: 'Bạn có muốn tạo mới menu '+ $("#Name").val() +' không?',
                showCloseButton: true,
                showCancelButton: true
            }).then((result) => {
                if (result.isConfirmed) {
                    var pubtime = ""; 
                    //if ($("#publishtime").val() != null) {
                    //    pubtime = $("#publishtime").val();
                    //} else {
                    //    var currentdate = new Date();
                    //    var datetime = currentdate.getFullYear() + "-"
                    //        + (currentdate.getMonth() + 1) + "-"
                    //        + currentdate.getDate() + " "
                    //        + currentdate.getHours() + ":"
                    //        + currentdate.getMinutes() + ":"
                    //        + currentdate.getSeconds();
                    //    pubtime = datetime; 
                    //}
                    var allData = [];
                    const objAllData = {
                        "alignment": $("#alignment").val(),
                        "Image": $("#Image").val(),
                        "tieude1": $("#tieu-de-1").val(),
                        "tieude2": $("#tieu-de-2").val(),
                        "tieude3": $("#tieu-de-3").val(),
                        "buttonName": $("#button-name").val(),
                        "buttonUrl": $("#button-url").val(), 
                    };

                    allData.push(objAllData);

                    var obj = {  
                        "Name": $("#Name").val(), 
                        "Description": JSON.stringify(allData),
                        "CreatedTime": $("#CreatedTime").val(),

                    }
                    debugger;
                    $.ajax({
                        url: "/viewstatus/api/add",
                        type: "POST",
                        contentType: "application/json",
                        data: JSON.stringify(obj),
                        success: function (responseData) {
                            Swal.fire({
                                title: '<strong>Đã tạo slide mới thành công!</strong>',
                                icon: 'success',
                                showCloseButton: true,
                                focusConfirm: false,
                            }).then(resultt => {
                                if (resultt.isConfirmed) {
                                    window.location.href = "/viewstatus/admin/list";
                                }
                            });
                        }
                    })
                } else if (result.isDenied) {
                    
                    print(e);
                }
            })
            }
            
        }
    </script>
</body>
</html>